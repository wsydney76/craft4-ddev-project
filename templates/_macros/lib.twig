{% macro img(image, config = []) %}

    {% set transform = config.transform ?? {width: 1024} %}
    {% set srcset = config.srcset ?? [1024, 640, 400] %}
    {% set attr = config.attr ?? {loading: 'lazy'} %}

    {% if transform.format is not defined %}
        {% set transform = transform|merge({format: 'webp'}) %}
    {% endif %}


    {{ image.img(transform, srcset)|attr(attr) }}

{% endmacro %}
